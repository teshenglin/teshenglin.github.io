<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>derivative | Te-Sheng Lin</title>
    <link>https://teshenglin.github.io/tags/derivative/</link>
      <atom:link href="https://teshenglin.github.io/tags/derivative/index.xml" rel="self" type="application/rss+xml" />
    <description>derivative</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Sun, 27 Oct 2019 00:00:00 +0000</lastBuildDate>
    <image>
      <url>https://teshenglin.github.io/img/icon-192.png</url>
      <title>derivative</title>
      <link>https://teshenglin.github.io/tags/derivative/</link>
    </image>
    
    <item>
      <title>用電腦算微分</title>
      <link>https://teshenglin.github.io/post/2019_derivate_evaluate/</link>
      <pubDate>Sun, 27 Oct 2019 00:00:00 +0000</pubDate>
      <guid>https://teshenglin.github.io/post/2019_derivate_evaluate/</guid>
      <description>

&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    前情提要: &lt;a href=&#34;https://teshenglin.github.io/post/2019_limit_evaluate&#34;&gt;用電腦算極限&lt;/a&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;這裡我們要講的是用數值計算來算函數的微分值.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;已知一個函數 $f(x)$ 在某個點 $a$ 的微分值定義是
$$
f&amp;rsquo;(a) = \lim_{h\to 0} \frac{f(a+h)-f(a)}{h}.
$$&lt;/p&gt;

&lt;p&gt;我們用一個簡單的例子試試看. 假設我們想求 $f(x)=x^2$ 在 $x=\pi$ 的微分. 根據定義我們有&lt;/p&gt;

&lt;p&gt;$$
f&amp;rsquo;(\pi) = \lim_{h\to 0} \frac{(\pi+h)^2-\pi^2}{h}.
$$&lt;/p&gt;

&lt;p&gt;接著我們將 $h$ 取靠近 $0$ 的 $1000$ 的點並帶入上列這個式子試著來算其極限值.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;1000×2 Array{Float64,2}:
 1.0    7.28319
 0.999  7.28219
 0.998  7.28119
 0.997  7.28019
 0.996  7.27919
 0.995  7.27819
 0.994  7.27719
 0.993  7.27619
 0.992  7.27519
 0.991  7.27419
 0.99   7.27319
 0.989  7.27219
 0.988  7.27119
 ⋮
 0.012  6.29519
 0.011  6.29419
 0.01   6.29319
 0.009  6.29219
 0.008  6.29119
 0.007  6.29019
 0.006  6.28919
 0.005  6.28819
 0.004  6.28719
 0.003  6.28619
 0.002  6.28519
 0.001  6.28419
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;上列數字左邊是 $h$ 值, 右邊為估計的微分值. 我們發現的確這個數字會越來越接近真實的解, 也就是 $2\pi$, 約等於 $6.283185307179586$.&lt;/p&gt;

&lt;p&gt;接著我們算一下這個值與真實值 $2\pi$ 之間的差, 我們取其絕對值來表示&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;1000×2 Array{Float64,2}:
 1.0    1.0
 0.999  0.999
 0.998  0.998
 0.997  0.997
 0.996  0.996
 0.995  0.995
 0.994  0.994
 0.993  0.993
 0.992  0.992
 0.991  0.991
 0.99   0.99
 0.989  0.989
 0.988  0.988
 ⋮
 0.012  0.012
 0.011  0.011
 0.01   0.01
 0.009  0.009
 0.008  0.008
 0.007  0.007
 0.006  0.006
 0.005  0.005
 0.004  0.004
 0.003  0.003
 0.002  0.002
 0.001  0.001
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;的確, 當 $x$ 越來越靠近 $\pi$ 時這個估計出來的微分值離 $2\pi$ 的距離越來越小.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Question:&lt;/strong&gt; 用數值計算微分能有多精確? 這個誤差能不能一直遞減下去?&lt;/p&gt;

&lt;p&gt;接著我們取更多靠近 $0$ 的點來計算微分的極限值, 我們列出其與真實值 $2\pi$ 之間的差, 並且把它畫出來.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;241×2 Array{Float64,2}:
 0.00673795   0.00673795
 0.00609675   0.00609675
 0.00551656   0.00551656
 0.00499159   0.00499159
 0.00451658   0.00451658
 0.00408677   0.00408677
 0.00369786   0.00369786
 0.00334597   0.00334597
 0.00302755   0.00302755
 0.00273944   0.00273944
 0.00247875   0.00247875
 0.00224287   0.00224287
 0.00202943   0.00202943
 ⋮
 7.64159e-13  0.000179905
 6.9144e-13   0.000756556
 6.25641e-13  9.69264e-5
 5.66103e-13  0.00196331
 5.12231e-13  0.00285478
 4.63486e-13  0.00227874
 4.1938e-13   0.0016747
 3.7947e-13   0.00576551
 3.43359e-13  0.00259406
 3.10684e-13  0.000421242
 2.81119e-13  0.00220945
 2.54367e-13  0.001922
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;觀察最後一列數字發現, 當 $h=2.54367*10^{-13}$ 時, 估計出來的微分值與真實值差了 $0.001922$ 這麼多!!&lt;/p&gt;

&lt;p&gt;我們把它畫出來看看, 橫軸是 $h$, 縱軸是 $\left|\frac{(\pi+h)^2-\pi^2}{h}-2\pi\right|$&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://teshenglin.github.io/post/figs/output_22_0.svg&#34; alt=&#34;svg&#34; /&gt;&lt;/p&gt;

&lt;p&gt;那誤差最小值出現在什麼時候呢?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;1×2 Array{Float64,2}:
 5.05653e-8  7.25251e-9
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;我們發現當 $h=5.05653*10^{-8}$ 時, 其估計出來的微分值離真實值誤差最小, 其誤差為 $7.25251*10^{-9}$.&lt;/p&gt;

&lt;p&gt;不過, WHY?? 為什麼誤差不會一直往下遞減? 其實這也是因為捨入誤差的關西.&lt;/p&gt;

&lt;p&gt;觀察一下我們的式子
$$
\frac{f(a+h)-f(a)}{h}
$$
當我們在用數值計算這個式子的時候其實並不完全是這樣子, 在分子應該會有捨入誤差在, 也就是說, 其實我們看到的數字應該是以下這個式子算出來的
$$
\frac{f(a+h)-f(a) + \epsilon}{h}
$$
其中的 $\epsilon$ 就是捨入誤差. 所以, 我們計算的時候會多出了 $\frac{\epsilon}{h}$ 這麼多.&lt;/p&gt;

&lt;p&gt;如果依我們之前所算的 $\epsilon\approx 10^{-16}$, 那當 $h=10^{-8}$ 時, 算出來的數字會多了大約 $\frac{10^{-16}}{10^{-8}} = 10^{-8}$.&lt;/p&gt;

&lt;p&gt;而當 $h=10^{-13}$ 時, 算出來的數字會多了大約 $\frac{10^{-16}}{10^{-13}} = 10^{-3}$. 跟我們之前所發現的完全吻合!!&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&#34;summary&#34;&gt;Summary:&lt;/h3&gt;

&lt;p&gt;最後總結一下:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;我們可以用數值計算來估計一個函數在某點的微分值
$$
f&amp;rsquo;(a) = \lim_{h\to 0} \frac{f(a+h)-f(a)}{h}.
$$&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;不過計算時 $h$ 值不能無限取小, 需考慮到捨入誤差的影響.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
</description>
    </item>
    
  </channel>
</rss>
